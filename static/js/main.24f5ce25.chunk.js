(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(e,t,a){},113:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(9),i=a.n(o),c=a(30),r=a(25),A=a(20),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:d.LOG_IN,payload:{nickname:e,isAuthenticated:t}}},m=function(e){return{type:d.IS_AUTH,payload:e}},u=function(e){return{type:d.IS_ONLINE,payload:e}},d={LOG_IN:"LOG_IN",IS_AUTH:"IS_AUTH",IS_ONLINE:"IS_ONLINE"},h={nickname:localStorage.length>1?localStorage.getItem("nickname"):"",isAuth:localStorage.length>1},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.LOG_IN:return{nickname:t.payload.nickname,isAuth:t.payload.isAuthenticated};case d.IS_AUTH:return{nickname:e.nickname,isAuth:t.payload};default:return e}},E={isOnline:!0},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.IS_ONLINE:return{isOnline:t.payload};default:return e}},f=Object(A.b)({login:g,chat:p}),v=Object(A.c)(f);console.log(v);var k=v,y=a(21),C=a(22),N=a(26),O=a(23),w=a(27),S=a(17),T=a(120),j=a(123),b=function(e){function t(){var e,a;Object(y.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(N.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(s)))).HandleInput=function(e){(0,a.props.dispatch)(l(e.target.value))},a.Chat=function(){(0,a.props.dispatch)(m(!0)),localStorage.setItem("nickname",a.props.login.nickname)},a.AuthorisedBefore=function(){(0,a.props.dispatch)(l(localStorage.getItem("nickname"),!0))},a}return Object(w.a)(t,e),Object(C.a)(t,[{key:"render",value:function(){return localStorage.getItem("nickname")?(this.AuthorisedBefore(),s.a.createElement(S.a,{to:{pathname:"/TestChat/chat"}})):this.props.login.isAuth?s.a.createElement(S.a,{to:{pathname:"/TestChat/chat"}}):s.a.createElement(T.a,{className:"form"},s.a.createElement(T.a.Group,null,s.a.createElement(T.a.Label,null,"Enter your nickname"),s.a.createElement(T.a.Control,{type:"text",placeholder:"Enter nickname",className:"input",onChange:this.HandleInput}),s.a.createElement(j.a,{variant:"primary",className:"logButton",onClick:this.Chat},"Let`s chat")))}}]),t}(s.a.Component),I=Object(r.b)(function(e){return{login:e.login}})(b),R=(a(75),I),L=a(124),J=a(116),M=a(117),Q=a(54),B=a(118),x=a(119),G=a(121),U=a(122),F=function(e){var t=e.info,a=function(){var e=new Date(t.time),a=e.getDate();a<10&&(a="0"+a);var n=e.getMonth()+1;n<10&&(n="0"+n);var s=e.getFullYear()%100;s<10&&(s="0"+s);var o=e.getHours()%100;o<10&&(o="0"+o);var i=e.getMinutes()%100;return i<10&&(i="0"+i),a+"."+n+"."+s+" "+o+"."+i};return e.my?s.a.createElement(U.a,{id:"message",className:"my",style:{backgroundColor:"#9999ff"}},s.a.createElement(U.a.Body,null,s.a.createElement("div",{className:"title"},s.a.createElement(U.a.Title,null,t.from),s.a.createElement(U.a.Text,null,a(t.time))),s.a.createElement(U.a.Text,{className:"messageText"},t.message))):s.a.createElement(U.a,{id:"message",style:{backgroundColor:"#f2f2f2"}},s.a.createElement(U.a.Body,null,s.a.createElement("div",{className:"title"},s.a.createElement(U.a.Title,null,t.from),s.a.createElement(U.a.Text,null,a(t.time))),s.a.createElement(U.a.Text,{className:"messageText"},t.message)))},Z=(a(76),F),z=a(41),V=a(64),Y=a(55),H=a.n(Y),D=a(56),P=a.n(D),X=a(57),K=a.n(X),W=a(58),q=a(59),_=a.n(q),$=function(e){function t(e){var a;Object(y.a)(this,t),(a=Object(N.a)(this,Object(O.a)(t).call(this,e))).scrollToBottom=function(){a.messagesEnd.scrollIntoView()},a.state={messages:[],text:""},a.active=!0,a.inputValue="",a.messagesEnd="",a.flag=!0,a.granted=!1;return a.socket=new W.a("wss://wssproxy.herokuapp.com",[],{connectionTimeout:5e3}),a.socket.binaryType="arraybuffer",a.addEventSocket(),a.NotificationRequested(),a}return Object(w.a)(t,e),Object(C.a)(t,[{key:"changeActive",value:function(){this.active=!this.active}},{key:"socketOpen",value:function(){(0,this.props.dispatch)(u(!0)),document.cookie.length>1&&this.sendMessage(),this.setState({messages:[]}),document.cookie="message= ; expires = Thu, 01 Jan 1970 00:00:00 GMT"}},{key:"socketMessage",value:function(e){this.setState(function(t){return{messages:t.messages.concat(JSON.parse(e.data).reverse())}}),console.log(this.active,this.granted,this.flag),this.active?this.refs.midiSounds.playChordNow(47,[60],.7):!this.flag&&this.granted&&this.sendNotification(JSON.parse(e.data)),this.flag&&this.scrollToBottom(),this.flag=!1}},{key:"NotificationRequested",value:function(){var e=this;"Notification"in window?Notification.requestPermission(function(t){"granted"===t&&(e.granted=!0)}):alert("This browser does not support desktop notification")}},{key:"addEventSocket",value:function(){var e=this;window.addEventListener("focus",function(){return e.changeActive()}),window.addEventListener("blur",function(){return e.changeActive()}),window.addEventListener("online",function(){return e.updateStatus()}),window.addEventListener("offline",function(){return e.updateStatus()}),this.socket.addEventListener("open",function(){return e.socketOpen()}),this.socket.addEventListener("message",function(t){return e.socketMessage(t)}),this.socket.addEventListener("close",function(){return e.socketClose()})}},{key:"socketClose",value:function(){(0,this.props.dispatch)(u(!1)),window.removeEventListener("focus",this.changeActive),window.removeEventListener("blur",this.changeActive),window.removeEventListener("online",this.updateStatus),window.removeEventListener("offline",this.updateStatus),this.socket.removeEventListener("open",this.socketOpen),this.socket.removeEventListener("message",this.socketMessage),this.socket.removeEventListener("close",this.socketClose)}},{key:"sendNotification",value:function(e){e.map(function(e){var t=e.message;return new Notification(e.from,{body:t})})}},{key:"updateStatus",value:function(){var e=this.props.dispatch;navigator.onLine?e(u(!0)):(this.socket.close(),this.socket.reconnect())}},{key:"closeSocket",value:function(){(0,this.props.dispatch)(m(!1)),this.socket.close(),localStorage.clear()}},{key:"saveMessage",value:function(e){this.setState({text:e.target.value})}},{key:"addEmoji",value:function(e){var t=e.native;this.setState(function(e,a){return{text:e.text+t}})}},{key:"sendMessage",value:function(){var e=this;this.socket.send(JSON.stringify({from:this.props.login.nickname,message:""!==this.state.text?this.state.text:document.cookie.replace(/(?:(?:^|.*;\s*)message\s\=\*\s*([^;]*).*$)|^.*$/,"$1")})),this.props.chat.isOnline||(document.cookie="message=".concat(this.state.text),this.setState(function(t){return{messages:t.messages.concat([{from:e.props.login.nickname,message:e.state.text,time:Date.now()}])}})),this.setState({text:""})}},{key:"returnMessages",value:function(){var e=this,t=s.a.createElement(L.a,{id:"popover-basic"},s.a.createElement(V.a,{onSelect:function(t){return e.addEmoji(t)}}));return s.a.createElement(J.a,{className:"cont"},s.a.createElement(M.a,{className:"chatContainer"},s.a.createElement(Q.a,{className:"pl-0"},s.a.createElement("ul",null,this.state.messages.length>0?this.state.messages.map(function(t){return t.from!==e.props.login.nickname?s.a.createElement("li",{key:Object(z.uniqueId)()},s.a.createElement(Z,{info:t})):s.a.createElement("li",{key:Object(z.uniqueId)(),className:"myMess"},s.a.createElement(Z,{info:t,my:!0}))}):s.a.createElement("li",null,s.a.createElement(B.a,{animation:"border",variant:"secondary"}))),s.a.createElement("div",{onClick:this.scrollToBottom,className:"arrow"},s.a.createElement(x.a,{src:K.a})),s.a.createElement("div",{ref:function(t){return e.messagesEnd=t}}))),s.a.createElement(M.a,{id:"typeMessage"},s.a.createElement(T.a,{onSubmit:function(){return e.sendMessage()}},s.a.createElement(G.a,{trigger:"click",placement:"top",overlay:t},s.a.createElement(x.a,{src:H.a,className:"emodji"})),s.a.createElement("textarea",{value:this.state.text,onChange:function(t){return e.saveMessage(t)}}),s.a.createElement(x.a,{src:P.a,className:"send",type:"submit",onClick:function(){return e.sendMessage()}})),s.a.createElement(_.a,{ref:"midiSounds",appElementName:"root",instruments:[47],className:"sound"})))}},{key:"render",value:function(){var e=this;return this.props.chat.isOnline?this.props.login.isAuth?s.a.createElement("div",null,s.a.createElement("div",{className:"titleChat"},s.a.createElement(j.a,{onClick:function(){return e.closeSocket()},className:"buttonExit",variant:"primary",style:{backgroundColor:"#9999ff"}},"LOG OUT"),s.a.createElement("h5",{className:"hello"},"Hello ",this.props.login.nickname)),this.returnMessages()):s.a.createElement(S.a,{to:{pathname:"/TestChat/login"}}):s.a.createElement("div",null,s.a.createElement("div",{className:"titleChat"},s.a.createElement(j.a,{onClick:function(){return e.closeSocket()},className:"buttonExit",variant:"primary",style:{backgroundColor:"#9999ff"}},"LOG OUT"),s.a.createElement("p",null,"Trying to connect")),this.returnMessages())}}]),t}(s.a.Component),ee=Object(r.b)(function(e){return{login:e.login,chat:e.chat}})($),te=(a(110),a(111),ee),ae=function(e){function t(e){return Object(y.a)(this,t),Object(N.a)(this,Object(O.a)(t).call(this,e))}return Object(w.a)(t,e),Object(C.a)(t,[{key:"render",value:function(){return s.a.createElement(S.d,null,s.a.createElement(S.a,{exact:!0,from:"/TestChat/",to:"/TestChat/login"}),s.a.createElement(S.b,{path:"/TestChat/login",component:R}),s.a.createElement(S.b,{path:"/TestChat/chat",component:te}))}}]),t}(s.a.Component);a(112),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));console.log(k),i.a.render(s.a.createElement(r.a,{store:k},s.a.createElement(c.a,null,s.a.createElement(ae,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},55:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAQAAABKfvVzAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfjCA0VFTHimNclAAACVUlEQVQ4y42UTUhUYRSGn3Pv1TJCHdFZqKRXkxHsh8jJNsEUpkQtglZZZItqIaQEbaJttGmRQSulwBJKiAJpYxNMBUGoiQpFEs5NEY0RnIEWjTPNPS3mOv72867u4T7v4fCd9/uENVL5tsdtlRAByoBFmSLCUPUn0VVGVj+doHbRjA8TQQBFyRAnzL2a0Q0GNaKXpYsa8te2yP4ixQy9S92NvwBMgIipt6UDm7xNOAgWxTQUlJ2O9CkYAFVXaaMya95SJuW07erwRnKC+pjdf8GzyvBVz9d+NFS0k+p/4mBiyzUVcfZqGL83e4xh8jiA34NiMq5pgl6txGi23FbxebhLDy/F1SucwQfEGaQXg1PcwAAEHy2WhHLjpOV93mhlxmnSY1mDTNjDc2a6WNNs88YKWQRyR2lqU2o6itZTBECR1kfrUtCUaykELMpyBouz1CEcpgSAEk5QDDRi5Qx+iSYo3GJdW0tJGMRQr5gnRnoTlCLG/AqjiwZTXrHMAE9Y2GT4rk8ZYDlrkC+GvCHjuSd5QJj4OjzOa3kok7jetiMGQ8RRoEAuUEo/L3BIApDE4bk+olQvsgNQlgib3YuJ/dRjAdXkM85bWSDJErOMMaDPZCeXOIkAyzJo9wpEG+n3wqe80z5GjB+6HSTpFkqQdo4gXvjO1Y4JQLST61Rko85PJhhhHijnEPso8GIzJ3fs+96Ni5hVt2ij4o+ZzbBAv31T3P+9orP0zNw9mskuO6fpg3TJcUo2PAIJItpd+2GFWtdPxWmghRAB/ECMKSK8sj+vfWZ+A5Cv18NDUkQqAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTA4LTEzVDE5OjIxOjQ5KzAyOjAwZTLF+AAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wOC0xM1QxOToyMTo0OSswMjowMBRvfUQAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC"},56:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfjCA4ANgFysF6dAAABmklEQVRIx82VS0sCURiGn+/MOLaIahte0sAwWrTqb/YfWgVFy0ioiJAoSZFMbOyGRURXixJLyTktJswopRkX9Z7FWXzne871ew/8uezZ8kzZ8p8v9j23FHRKUsGruOMHoIEa13KktySlSom6HwBAk2tOyLNJJnnlBwCgqXLMPrt6Z6AUf/MOcFXnnILs6pyRSzz5AQC0uCNPhrza43zC8Q5w1aAoab2tbXVi1ePaO8BVhbRsUOJUPSTe/AAAedYZVsjKmdxO1L8CDrCwCGIRJIDRg9LCZlXWdJFqqzb1MbGUpwk5YQkRJsQoQwQwMTE/evUNc8MmS+zwaNQSLZDOWNYYHFFhHXGiEiFKlAjDKAxUu7njG3KoF9Sic6Ga0mPJFISRwLjEGJOYE5MYEYbaa9I8sqzmFH3JeelzCzT6P0SP15hiFbvzGk2SXh4SFW6Sr50R8xfZFdJsSJen3BvQoMg6WV2WrsXUDdAuZ3JcTvYo558AngzlK6DD0oK/tLRPgE9TdQF92LpJ1f1Y8PmxmMzJPHvJpvfU/6J3wsrdL0YCI74AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMDgtMTNUMjI6NTQ6MDErMDI6MDCGLcHaAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTA4LTEzVDIyOjU0OjAxKzAyOjAw93B5ZgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII="},57:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAQAAABKfvVzAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfjCA8RICCHGVU2AAAAZklEQVQ4y+3QMRKAIAxE0c1xOCGlofOC4HG0yIghooGeTcXMfw3Amj8qEftEzgSME+KQCBglxCEBJA+fSF6BR+5cgT/y5A34Ijo3oEfa/AUssXl3JZZT7tj8z1ZkOAeAzJkn8jWzC5B+LU7dNIsbAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTA4LTE1VDE1OjMyOjMyKzAyOjAwjmIsxwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wOC0xNVQxNTozMjozMiswMjowMP8/lHsAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC"},65:function(e,t,a){e.exports=a(113)},75:function(e,t,a){},76:function(e,t,a){}},[[65,1,2]]]);
//# sourceMappingURL=main.24f5ce25.chunk.js.map